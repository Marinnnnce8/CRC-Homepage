/*! NBkit - Nav | @version 1.0.2 | @author NB Communication Ltd <info@nbcommunication.com> | @copyright 2020 */
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("uikit"),require("nbkit")):"function"==typeof define&&define.amd?define("nbkitnav",["uikit","nbkit"],i):(t="undefined"!=typeof globalThis?globalThis:t||self).NBkitNav=i(t.UIkit,t.NBkit)}(this,(function(t,i){"use strict";return UIkit.component("nbNav",{args:"breakpoint",props:{back:String,breakpoint:Number,toggle:String},data:{active:void 0,back:"Back",breakpoint:960,clsBack:"back",clsDesktop:"desktop",clsDrop:"uk-navbar-dropdown",clsHidden:"uk-hidden",isDesktop:!0,navbar:void 0,ns:void 0,toggle:".uk-navbar-toggle",ukNavbar:{},ukNavbarToggle:{}},beforeConnect:function(){if(i.util.profilerStart("NBkit.Nav.beforeConnect"),this.ns=i.util.getClassName(this),this.clsBack=this.ns+"-"+this.clsBack,this.clsDesktop=this.ns+"-"+this.clsDesktop,this.navbar=this.$el.closest("[data-uk-navbar]"),!this.navbar)throw new Error("The UIkit Navbar component could not be found.");this.ukNavbar=t.util.parseOptions(t.util.data(this.navbar,"uk-navbar")),this.ukNavbarToggle={},this.toggle&&(this.toggle=t.util.$(this.toggle),this.toggle&&(this.ukNavbarToggle=t.util.parseOptions(t.util.data(this.toggle,"uk-toggle")))),i.util.profilerStop("NBkit.Nav.beforeConnect")},connected:function(){i.util.profilerStart("NBkit.Nav.connected");var e=this,n=this.$el.parentElement,l=this.ns+"-open",a="."+this.clsDrop;t.util.addClass(n,this.clsDesktop),this.dropdowns(),this.checkBreakpoint(),t.util.addClass(n,this.ns);var s=t.util.$('.uk-active > a[href="'+window.location.pathname+'"]');this.active=s?s.closest(a):null,t.util.$$(".uk-parent > a").forEach((function(i){t.util.on(i,"click",(function(t){return e.active=t.target.nextElementSibling}))})),t.util.$$("."+this.clsBack).forEach((function(i){t.util.on(i,"click",(function(i){var n=i.target.closest(a);if(e.active=null,n){var l=(n=n.parentElement).closest("div");l&&t.util.trigger(l,"show"),e.active=n.closest(a)}}))})),t.util.on(n,"beforeshow",(function(i){if(!e.isDesktop&&i.target===n&&(t.util.addClass(t.util.$("body"),l),e.active)){var s=e.active,o=[];do{s&&o.push(s),s=(s=s.parentElement)?s.closest(a):null}while(s);o.reverse().forEach((function(t){t[UIkit.data].drop.show()}))}})),t.util.on(n,"hide",(function(i){return i.target==n?t.util.removeClass(t.util.$("body"),l):null})),t.util.on(window,"resize",i.util.debounce((function(){return e.checkBreakpoint()}),i.options.duration)),i.util.profilerStop("NBkit.Nav.connected")},events:[{name:"switch",handler:function(){i.util.profilerStart("NBkit.Nav.events.switch");var e=this.$el,n=this.navbar,l=this.toggle,a=t.util.$$("[data-uk-drop]",e),s=this.clsDesktop,o=this.ns+"-mobile",r=this.ns+"-title",u=this.clsBack,d="uk-navbar-dropdown-nav",h=this.clsHidden,c=e.parentElement;if(l){var p=t.util.attr(l,"href");p&&"#"!==p||(p=i.util.data(l,"uk-toggle").target),p&&(c=t.util.$(p))}if(this.isDesktop)t.util.hasClass(c,s)||(t.util.removeClass(c,o),t.util.addClass(c,s),t.util.removeAttr(c,"hidden",!0),a.length&&t.util.removeAttr(a,"hidden"),l&&t.util.attr(l,"hidden"),n&&(UIkit.navbar(n).$destroy(),UIkit.navbar(n,this.ukNavbar)),t.util.addClass(l,h),t.util.$$("."+d,e).forEach((function(i){t.util.remove(t.util.$("."+u).parentElement),t.util.remove(t.util.$("."+r).parentElement)})));else if(!t.util.hasClass(c,o)){if(t.util.removeClass(c,s),t.util.addClass(c,o),t.util.attr(c,"hidden",!0),a.length&&t.util.attr(a,"hidden",!0),l&&t.util.removeAttr(l,"hidden"),n){var k=this.ukNavbar;UIkit.navbar(n).$destroy(),k.mode="click",k.animation=this.ukNavbarToggle.animation,UIkit.navbar(n,k)}t.util.removeClass(l,h);var v=this,f="."+this.clsDrop;t.util.$$("."+d,e).forEach((function(e){var n=i.util.getPreviousSibling(e.closest(f),"a");t.util.prepend(e,i.util.wrap([i.util.link(t.util.attr(n,"href"),n.innerText||n.textContent,r),i.util.link({class:u,dataUkToggle:{animation:v.ukNavbarToggle.animation,cls:"uk-open",target:"#"+e.closest(f).id}},v.back)],"li"))}))}i.util.profilerStop("NBkit.Nav.events.switch")}}],methods:{checkBreakpoint:function(){var i,e,n=this.isDesktop,l=window.innerWidth>this.breakpoint,a=this;n&&l?(t.util.$$("> li > a",this.$el).forEach((function(t){(i=document.createElement("div")).style.position="absolute",i.style.left="-99in",i.style.whiteSpace="nowrap",i.style.fontFamily=window.getComputedStyle(t,null).getPropertyValue("font-family"),i.style.fontSize=window.getComputedStyle(t,null).getPropertyValue("font-size"),i.style.paddingLeft=window.getComputedStyle(t,null).getPropertyValue("padding-left"),i.style.paddingRight=window.getComputedStyle(t,null).getPropertyValue("padding-right"),i.innerHTML=t.textContent,document.body.appendChild(i),e=i.clientWidth,document.body.removeChild(i),t.offsetWidth&&t.offsetWidth<e&&(a.isDesktop=!1)})),a.isDesktop||(this.breakpoint=window.innerWidth)):this.isDesktop=l;this.isDesktop!==n&&t.util.trigger(this.$el,"switch")},dropdowns:function(e){t.util.isUndefined(e)&&(e=this.$el);var n,l,a,s=this;t.util.$$("> li > ul, > li > div",e).forEach((function(e){n=[],s.$el.id?n.push(s.$el.id):s.$el.parentElement.id&&n.push(s.$el.parentElement.id),n.push(s.ns),t.util.hasAttr(e,"id")?n.push(t.util.attr(e,"id")):((l=e.previousElementSibling)||(l=t.util.$("a",e.closest(".uk-parent"))),(a=t.util.attr(l,"href"))&&"#"!==a?("/"===a.substr(0,1)&&(a=a.slice(1)),n.push(a.replace(/\//g,"-"))):n.push(t.util.hyphenate(l.textContent.replace(/\s/g,"")))),t.util.wrapAll(e,i.util.attrs({id:n.join("_"),class:s.clsDrop},"div",!0)),t.util.addClass(e,"uk-navbar-dropdown-nav"),s.dropdowns(e)}))}}})}));
